import os
from pathlib import Path

from dotenv import load_dotenv

load_dotenv()

BASE_DIR = Path(__file__).resolve().parent.parent

TELEGRAM_BOT_TOKEN: str = os.environ["TELEGRAM_BOT_TOKEN"]
NAVER_CLIENT_ID: str = os.environ["NAVER_CLIENT_ID"]
NAVER_CLIENT_SECRET: str = os.environ["NAVER_CLIENT_SECRET"]
FERNET_KEY: str = os.environ["FERNET_KEY"]
DB_PATH: str = os.environ.get("DB_PATH", str(BASE_DIR / "data" / "tasa-check.db"))

# /check 시간 윈도우 최대값 (초)
CHECK_MAX_WINDOW_SECONDS: int = 3 * 60 * 60

# /report 시간 윈도우 (초) — 최근 3시간 기사 수집
REPORT_MAX_WINDOW_SECONDS: int = 3 * 60 * 60

# 캐시 보관 기간 (일)
CACHE_RETENTION_DAYS: int = 5

# 관리자 Telegram ID
ADMIN_TELEGRAM_ID: str = "8571411084"

# 부서별 프로필 (취재 영역 + 중요도 판단 기준)
DEPARTMENT_PROFILES: dict[str, dict] = {
    "사회부": {
        "coverage": (
            "사건·사고, 경찰·검찰 수사, 법원 재판, 인권, 재난·안전, 교육, 노동, 환경, 지방자치, "
            "부동산·주거 (시민 생활 영향), 의료·보건·복지, 인구·저출생·고령화, 소비자·생활경제"
        ),
        "criteria": [
            "공식 수사 조치: 체포, 구속, 기소, 영장 청구/기각, 판결 선고",
            "중대 사건·사고: 다수 사상자 발생, 사회적 관심이 집중된 대형 사건·재난",
            "수사 국면 전환: 소환→구속, 수사→기소, 1심→항소 등 단계 변화",
            "사회적 파장: 다수 언론 보도, 여론 형성, 후속 보도 가능성 높은 사안",
            "사회 구조적 이슈: 부동산·주거, 인구, 의료·복지 등 시민 생활에 직접 영향을 미치는 정책 발표 또는 통계",
        ],
        "report_keywords": [
            "경찰 수사", "검찰 기소", "법원 판결", "사건사고",
            "재난 안전", "교육 정책", "노동 노사",
            "부동산 정책", "의료 보건", "복지 정책",
            "인권 차별", "환경 기후", "저출생 고령화",
        ],
    },
    "정치부": {
        "coverage": (
            "국회 입법, 정당 동향, 대통령실·행정부, 선거, 외교·안보, 남북관계, 헌법재판소, "
            "검찰·법무 (정치적 측면), 여론·정치 지형 변화"
        ),
        "criteria": [
            "입법 조치: 법안 발의·통과·부결, 상임위 의결, 본회의 표결",
            "행정부 결정: 대통령 발언·지시, 국무회의 의결, 장관급 인사",
            "정당 동향: 지도부 교체, 당론 변경, 공천·징계 등 공식 결정",
            "외교·안보: 정상회담, 조약·협정, 대북 관련 공식 조치",
        ],
        "report_keywords": [
            "국회", "대통령실", "여당", "야당",
            "외교", "헌법재판소", "선거",
            "국무회의", "정당", "남북관계",
            "안보 국방", "법무부 검찰",
        ],
    },
    "경제부": {
        "coverage": (
            "거시경제, 금융·통화 정책, 부동산, 세제·재정, 금융감독, 가계·소비 지표, "
            "가상자산·핀테크, 국제경제 (Fed 등 국내 파급력 있는 해외 이슈), 물가·생활경제"
        ),
        "criteria": [
            "정책 결정: 기준금리 변동, 세제 개편, 부동산 규제, 재정 정책 발표",
            "주요 지표: GDP, 물가, 고용, 수출입, 가계부채 등 공식 통계 발표",
            "금융 이슈: 금융사 제재, 시장 급변동, 환율·주가 유의미한 변동",
            "규제·감독: 공정위 제재, 금감원 조치, 대규모 과징금 부과",
            "국제경제: 주요국 통화 정책, 글로벌 경기 지표 등 국내 시장에 직접 영향을 미치는 해외 동향",
        ],
        "report_keywords": [
            "기준금리", "부동산 규제", "물가 상승",
            "수출 실적", "금융 정책", "환율",
            "가계부채", "GDP", "세제 개편",
            "가상자산 코인", "공정위 금감원", "고용 실업", "미국 연준",
        ],
    },
    "산업부": {
        "coverage": (
            "대기업·중소기업, IT·반도체·배터리·자동차, AI·로봇·바이오, "
            "스타트업, 통신, 에너지, 유통·물류, 건설·인프라, ESG·탄소중립"
        ),
        "criteria": [
            "기업 공식 발표: 실적, M&A, 대규모 투자·구조조정, 인사",
            "산업 정책: 정부 산업 지원책, 규제 변경, 통상·관세 조치",
            "기술 동향: 신제품 출시, 기술 경쟁 구도 변화, 특허 분쟁",
            "시장 변동: 업계 판도 변화, 공급망 이슈, 대규모 계약·수주",
        ],
        "report_keywords": [
            "반도체", "배터리", "AI 인공지능",
            "대기업 실적", "M&A 인수합병", "스타트업",
            "에너지", "자동차 산업", "통신 5G",
            "바이오 제약", "유통 물류", "건설 인프라", "탄소중립 ESG",
        ],
    },
    "문화부": {
        "coverage": (
            "문화·예술, 방송·미디어, 연예, 출판, 관광, 종교, 교육 정책, 문화재, "
            "게임, 웹툰·웹소설, 한류·글로벌 콘텐츠, OTT·플랫폼"
        ),
        "criteria": [
            "수상·선정: 국제 영화제·문학상 수상, 유네스코 등재 등 공식 성과",
            "정책·제도: 문화 관련 법안·정책 발표, 교육과정 개편, 방송 규제",
            "업계 이슈: 주요 콘텐츠 흥행·논란, 플랫폼 정책 변경, 저작권 분쟁",
            "사회적 관심: 공인 관련 공식 조치(기소·판결), 대중적 파장이 큰 사안",
        ],
        "report_keywords": [
            "영화 흥행", "드라마", "방송",
            "출판", "관광", "게임",
            "웹툰", "OTT", "한류",
            "K팝 아이돌", "문화재", "문화 정책",
        ],
    },
    "스포츠부": {
        "coverage": "프로 스포츠(야구·축구·농구·배구), 국제 대회, 올림픽, e스포츠, 체육 행정",
        "criteria": [
            "경기 결과: 우승·준우승, 신기록, 시즌 주요 변곡점(매직넘버 등)",
            "선수 동향: FA·트레이드·이적, 은퇴, 부상(주전급), 징계",
            "대회·행사: 올림픽·월드컵·아시안게임 관련 공식 결정, 개최지 선정",
            "체육 행정: 협회·연맹 공식 결정, 승부조작·도핑 등 제재 조치",
        ],
        "report_keywords": [
            "프로야구", "축구 대표팀", "올림픽",
            "FA 이적", "체육 행정", "프로축구",
            "프로농구", "프로배구", "e스포츠",
            "월드컵", "아시안게임",
        ],
    },
}

# 부서 목록 (DEPARTMENT_PROFILES 키에서 자동 생성)
DEPARTMENTS: list[str] = list(DEPARTMENT_PROFILES.keys())
